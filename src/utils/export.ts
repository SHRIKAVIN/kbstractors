import * as XLSX from 'xlsx';
import type { RentalRecord } from '../types/rental';
import { formatCurrency } from './calculations';
// PDFMake import and font setup
import pdfMake from 'pdfmake/build/pdfmake';
import pdfFonts from 'pdfmake/build/vfs_fonts';
// @ts-ignore
import tamilFont from '../assets/fonts/Noto_Sans_Tamil/NotoSansTamil-Regular.ttf';

// Embed the base64-encoded Tamil font in pdfmake VFS
const notoSansTamilBase64 = `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Wd9aT1qqWspbL1uMW+RcFFxLXJxc510bXT5dRl1PXVhdYV1qXXNde12SXZpdol3IXeBd+F4iXkNeZF6CXqhe0F7eXwNfJl8zX0xfZAAAACcB2gADAAEECQAAAJgEjgADAAEECQABAB4EcAADAAEECQACAA4EYgADAAEECQADAEAEIgADAAEECQAEAC4D9AADAAEECQAFABoD2gADAAEECQAGACoDsAADAAEECQAHAEQDbAADAAEECQAIACoDQgADAAEECQAJAEQC/gADAAEECQAKAEICvAADAAEECQALAD4CfgADAAEECQAMADwCQgADAAEECQANASIBIAADAAEECQAOADYA6gADAAEECQAZABoA0AADAAEECQEAAAwAxAADAAEECQEBAAoAugADAAEECQECAAgAsgADAAEECQEDABQAngADAAEECQEEAAoAlAADAAEECQEGAAwAiAADAAEECQEHABAAeAADAAEECQEIAAgAcAADAAEECQEJABIAXgADAAEECQEKAAoAVAADAAEECQELABwAOAADAAEECQEMABIAJgADAAEECQENABoADAADAAEECQEOAAwAAAADAAEECQEPAAgAsgADAAEECQEQABQAngADAAEECQERAAoAlAADAAEECQESAA4EYgADAAEECQETAAwAiAADAAEECQEUABAAeAADAAEECQEVAAgAcAADAAEECQEWABIAXgADAAEECQEXAAoAVABOAG8AcgBtAGEAbABTAGUAbQBpAEMAbwBuAGQAZQBuAHMAZQBkAEMAbwBuAGQAZQBuAHMAZQBkAEUAeAB0AHIAYQBDAG8AbgBkAGUAbgBzAGUAZABCAGwAYQBjAGsARQB4AHQAcgBhAEIAbwBsAGQAQgBvAGwAZABTAGUAbQBpAEIAbwBsAGQATQBlAGQAaQB1AG0ATABpAGcAaAB0AEUAeAB0AHIAYQBMAGkAZwBoAHQAVABoAGkAbgBXAGkAZAB0AGgAVwBlAGkAZwBoAHQATgBvAHQAbwBTAGEAbgBzAFQAYQBtAGkAbABoAHQAdABwAHMAOgAvAC8AcwBjAHIAaQBwAHQAcwAuAHMAaQBsAC4AbwByAGcALwBPAEYATABUAGgAaQBzACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAGkAcwAgAGwAaQBjAGUAbgBzAGUAZAAgAHUAbgBkAGUAcgAgAHQAaABlACAAUwBJAEwAIABPAHAAZQBuACAARgBvAG4AdAAgAEwAaQBjAGUAbgBzAGUALAAgAFYAZQByAHMAaQBvAG4AIAAxAC4AMQAuACAAVABoAGkAcwAgAGwAaQBjAGUAbgBzAGUAIABpAHMAIABhAHYAYQBpAGwAYQBiAGwAZQAgAHcAaQB0AGgAIABhACAARgBBAFEAIABhAHQAOgAgAGgAdAB0AHAAcwA6AC8ALwBzAGMAcgBpAHAAdABzAC4AcwBpAGwALgBvAHIAZwAvAE8ARgBMAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBtAG8AbgBvAHQAeQBwAGUALgBjAG8AbQAvAHMAdAB1AGQAaQBvAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBnAG8AbwBnAGwAZQAuAGMAbwBtAC8AZwBlAHQALwBuAG8AdABvAC8ARABlAHMAaQBnAG4AZQBkACAAYgB5ACAATQBvAG4AbwB0AHkAcABlACAAZABlAHMAaQBnAG4AIAB0AGUAYQBtAC4ASgBlAGwAbABlACAAQgBvAHMAbQBhACAALQAgAE0AbwBuAG8AdAB5AHAAZQAgAEQAZQBzAGkAZwBuACAAVABlAGEAbQBNAG8AbgBvAHQAeQBwAGUAIABJAG0AYQBnAGkAbgBnACAASQBuAGMALgBOAG8AdABvACAAaQBzACAAYQAgAHQAcgBhAGQAZQBtAGEAcgBrACAAbwBmACAARwBvAG8AZwBsAGUAIABJAG4AYwAuAE4AbwB0AG8AUwBhAG4AcwBUAGEAbQBpAGwALQBSAGUAZwB1AGwAYQByAFYAZQByAHMAaQBvAG4AIAAyAC4AMAAwADQATgBvAHQAbwAgAFMAYQBuAHMAIABUAGEAbQBpAGwAIABSAGUAZwB1AGwAYQByADIALgAwADAANAA7AEcATwBPAEcAOwBOAG8AdABvAFMAYQBuAHMAVABhAG0AaQBsAC0AUgBlAGcAdQBsAGEAcgBSAGUAZwB1AGwAYQByAE4AbwB0AG8AIABTAGEAbgBzACAAVABhAG0AaQBsAEMAbwBwAHkAcgBpAGcAaAB0ACAAMgAwADIAMgAgAFQAaABlACAATgBvAHQAbwAgAFAAcgBvAGoAZQBjAHQAIABBAHUAdABoAG8AcgBzACAAKABoAHQAdABwAHMAOgAvAC8AZwBpAHQAaAB1AGIALgBjAG8AbQAvAG4AbwB0AG8AZgBvAG4AdABzAC8AdABhAG0AaQBsACkAAQAAAAoAWgDmAANERkxUADhsYXRuABR0bWwyADgAAAACTU9MIAAaUk9NIAAQAAD//wACAAIABQAA//8AAgACAAQABAAAAAD//wAHAAAAAQACAAMABgAHAAgACWFidnMAhGFraG4AfmNjbXAAXmhhbG4AWGxvY2wAUmxvY2wATHBzdHMARHN1YnMAPnN1cHMAOAAAAAEACwAAAAEACgAAAAIABAAFAAAAAQAQAAAAAQAPAAAAAQADAAAADgAMAAwADAAMAAwADAAMAA4ADgAOAA4ADgAOAA4AAAABAAIAAAACAAAAAQARBnAFFgT0A7YCBgFkAUwBPgEwASIBCgD8AMoAvAA6ACQAJAABAAAAAQAIAAEABgABAAEAAgFSAcQABAAAAAEACAABAGYACABcAFIASAA+ADQAKgAgABYAAQAEAdIAAgIDAAEABAGfAAICAwABAAQBjwACAgMAAQAEAXkAAgIDAAEABAFgAAICAwABAAQBLgACAgMAAQAEAR4AAgIDAAEABAEIAAICAwABAAgBAQEWASYBWAFyAYcBlwHKAAEAAAABAAgAAQAwAAEABgAAAAEACAADAAAAAQAiAAEAEgABAAAADQACAAIA+gD+AAAB+gIAAAUAAQACAZcBoAABAAAAAQAIAAEAFAAwAAEAAAABAAgAAQAGADMAAQADALkAugC7AAEBAAABAAgAAQDKAHoAAQEAAAEACAABALwAewABAQAAAQAIAAEArgB9AAEBAAABAAgAAQAGAHwAAQADACoALAAtAAYBAAAFAH4AYgBEACoAEAADAAEALAABABIAAAABAAAABgABAAIALAAtAAMAAQASAAEAZgAAAAEAAAAJAAEAAgAmAEwAAwABABIAAQBMAAAAAQAAAAgAAQAEABMAHAAeACQAAwABABIAAQAuAAAAAQAAAAcAAQADABQAIAAoAAMAAQAYAAEAEgAAAAEAAAAGAAEAAQAqAAEABAASABYAGQAaAAQBAAABAAgAAQGSABMBgAFuAVwBSgEwAR4BDAD6AOgA1gDEALIAoACOAHQAYgBQADYALAABAAQAnwACACoAAwAUAA4ACACcAAIALACdAAIALQCbAAIAKwACAAwABgCZAAIALACaAAIALQACAAwABgCWAAIALACXAAIALQADABQADgAIAJMAAgAsAJQAAgAtAJEAAgAqAAIADAAGAI8AAgAsAJAAAgAtAAIADAAGAIwAAgAsAI0AAgAtAAIADAAGAIkAAgAsAIoAAgAtAAIADAAGAIYAAgAsAIcAAgAtAAIADAAGAIMAAgAsAIQAAgAtAAIADAAGAIAAAgAsAIEAAgAtAAIADAAGAH0AAgAsAH4AAgAtAAIADAAGAHoAAgAsAHsAAgAtAAIADAAGAHcAAgAsAHgAAgAtAAMAFAAOAAgAdAACACwAdQACAC0AcgACACoAAgAMAAYAcAACACwAcQACAC0AAgAMAAYAbAACACwAbQACAC0AAgAMAAYAaQACACwAagACAC0AAgAMAAYAZgACACwAZwACAC0AAgADABIAFAAAABYAJAADACcAJwASAAQBAAABAAgAAQEmABgBHAESAQgA/gD0AOoA4ADWAMwAwgC4AK4ApACaAJAAhgB8AHIAaABeAFQASgBAADYAAQAEAGQAAgA0AAEABABjAAIANAABAAQAYgACADQAAQAEAGEAAgA0AAEABABgAAIANAABAAQAXwACADQAAQAEAF4AAgA0AAEABABdAAIANAABAAQAXAACADQAAQAEAFsAAgA0AAEABABaAAIANAABAAQAWQACADQAAQAEAFgAAgA0AAEABABXAAIANAABAAQAVgACADQAAQAEAFUAAgA0AAEABABUAAIANAABAAQAUwACADQAAQAEAFIAAgA0AAEABABRAAIANAABAAQAUAACADQAAQAEAE8AAgA0AAEABABOAAIANAABAAQATQACADQAAgACABIAKAAAAEwATAAXAAQAAAABAAgAAQAUAAEACAABAAQATAADADQAJgABAAEAEgAEAQAAAQAIAAEBMAAZASYBHAESAQgA/gD0AOoA4ADWAMwAwgC4AK4ApACaAJAAhgB8AG4AZABYAE4ARAA4ADgAAQAEAKMAAwAfACsAAQAEAKIAAgArAAEABAChAAIAKwACABoABgCgAAIAKwABAAQAngACACsAAQAEAKMABAA0AB8AKwABAAQAmAACACsAAQAEAJUAAgArAAEABACSAAIAKwABAAQAjgACACsAAQAEAIsAAgArAAEABACIAAIAKwABAAQAhQAC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AhMAAAECAQMAAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwEcAR0BHgEfASABIQEiASMBJAElASYBJwEoASkBKgErASwBLQEuAS8BMAExATIBMwE0ATUBNgE3ATgBOQE6ATsBPAE9AT4BPwFAAUEBQgFDAUQBRQFGAUcBSAFJAUoBSwFMAU0BTgFPAVABUQFSAVMBVAFVAVYBVwFYAVkBWgFbAVwBXQFeAV8BYAFhAWIBYwFkAWUBZgFnAWgBaQFqAWsBbAFtAW4BbwFwAXEBcgFzAXQBdQF2AXcBeAF5AXoBewF8AX0BfgF/AYABgQGCAYMBhAGFAYYBhwGIAYkBigGLAYwBjQGOAY8BkAGRAZIBkwGUAZUBlgGXAZgBmQGaAZsBnAGdAZ4BnwGgAaEBogGjAaQBpQGmAacBqAGpAaoBqwGsAa0BrgGvAbABsQGyAbMBtAG1AbYBtwG4AbkBugG7AbwBvQG+Ab8BwAHBAcIBwwHEAcUBxgHHAcgByQHKAcsBzAHNAc4BzwHQAdEB0gHTAdQB1QHWAdcB2AHZAdoB2wHcAd0B3gHfAeAB4QHiAeMB5AHlAeYB5wHoAekB6gHrAewB7QHuAe8B8AHxAfIB8wARALUAtgC3AKkAqgH0AfUB9gH3AfgA3ACDACQAyQH5AMcAYgCtAfoB+wBjAK4AkAAlACYA/QD/AGQB/AAnAOkB/QH+ACgAZQH/AMgAygIAAMsCAQICACkAKgD4AgMCBAArAgUALAIGAMwAzQDOAPoAzwIHAggALQAuAgkALwIKAgsCDADiADAAMQINAg4CDwBmAhAAMgDQANEAZwDTAhECEgCRAK8AsAAzAO0ANAA1AhMCFAIVADYCFgDkAPsCFwIYADcCGQIaADgA1AIbANUAaADWAhwCHQIeAh8AOQA6AiACIQIiAiMAOwA8AOsCJAC7AiUAPQImAOYCJwBEAGkCKABrAGwAagIpAioAbgBtAKAARQBGAP4BAABvAisARwDqAiwBAQBIAHACLQByAHMCLgBxAi8CMABJAEoA+QIxAjIASwIzAEwA1wB0AHYAdwB1AjQCNQI2AE0CNwBOAjgATwI5AjoCOwDjAFAAUQI8Aj0CPgB4Aj8AUgB5AHsAfAB6AkACQQChAH0AsQBTAO4AVABVAkICQwJEAFYCRQDlAPwCRgCJAFcCRwJIAFgAfgJJAIAAgQB/AkoCSwJMAk0AWQBaAk4CTwJQAlEAWwBcAOwCUgC6AlMAXQJUAOcCVQCdAJ4AowCiAMMAhwDEAMUAvgC/ACMACQCIAIYAiwCKAIwAhAAHAlYAhQCWAlcCWAJZAloCWwJcAl0CXgJfAmAAjgBDAI0A3wDYAOEA2wDdANkCYQDeAOACYgJjAmQETlVMTAJDUg1hbnVzdmFyYXRhbWlsDHZpc2FyZ2F0YW1pbAZhdGFtaWwHYWF0YW1pbAZpdGFtaWwHaWl0YW1pbAZ1dGFtaWwHdXV0YW1pbAZldGFtaWwHZWV0YW1pbAdhaXRhbWlsEGFhdm93ZWxzaWdudGFtaWwPaXZvd2Vsc2lnbnRhbWlsEGlpdm93ZWxzaWdudGFtaWwPdXZvd2Vsc2lnbnRhbWlsEHV1dm93ZWxzaWdudGFtaWwPZXZvd2Vsc2lnbnRhbWlsEGVldm93ZWxzaWdudGFtaWwQYWl2b3dlbHNpZ250YW1pbA9vdm93ZWxzaWdudGFtaWwQb292b3dlbHNpZ250YW1pbBBhdXZvd2Vsc2lnbnRhbWlsC3ZpcmFtYXRhbWlsDG9obXNpZ250YW1pbBFhdWxlbmd0aG1hcmt0YW1pbAl6ZXJvdGFtaWwIb25ldGFtaWwIdHdvdGFtaWwKdGhyZWV0YW1pbAlmb3VydGFtaWwJZml2ZXRhbWlsCHNpeHRhbWlsCnNldmVudGFtaWwKZWlnaHR0YW1pbAluaW5ldGFtaWwIdGVudGFtaWwMaHVuZHJlZHRhbWlsDXRob3VzYW5kdGFtaWwMZGF5c2lnbnRhbWlsDm1vbnRoc2lnbnRhbWlsDXllYXJzaWdudGFtaWwOZGViaXRzaWdudGFtaWwPY3JlZGl0c2lnbnRhbWlsEGFzYWJvdmVzaWdudGFtaWwOcnVwZWVzaWdudGFtaWwMbnVtc2lnbnRhbWlsCXRjaGF0YW1pbA5rYXByZWhhbGZ0YW1pbA9uZ2FwcmVoYWxmdGFtaWwOY2FwcmVoYWxmdGFtaWwOamFwcmVoYWxmdGFtaWwPbnlhcHJlaGFsZnRhbWlsD3R0YXByZWhhbGZ0YW1pbA9ubmFwcmVoYWxmdGFtaWwOdGFwcmVoYWxmdGFtaWwObmFwcmVoYWxmdGFtaWwQbm5uYXByZWhhbGZ0YW1pbA5wYXByZWhhbGZ0YW1pbA5tYXByZWhhbGZ0YW1pbA55YXByZWhhbGZ0YW1pbA5yYXByZWhhbGZ0YW1pbA9ycmFwcmVoYWxmdGFtaWwObGFwcmVoYWxmdGFtaWwPbGxhcHJlaGFsZnRhbWlsEGxsbGFwcmVoYWxmdGFtaWwOdmFwcmVoYWxmdGFtaWwPc2hhcHJlaGFsZnRhbWlsD3NzYXByZWhhbGZ0YW1pbA5zYXByZWhhbGZ0YW1pbA5oYXByZWhhbGZ0YW1pbBB0Y2hhcHJlaGFsZnRhbWlsEmthaWl2b3dlbHNpZ250YW1pbBFrYXV2b3dlbHNpZ250YW1pbBJrYXV1dm93ZWxzaWdudGFtaWwTbmdhaWl2b3dlbHNpZ250YW1pbBJuZ2F1dm93ZWxzaWdudGFtaWwTbmdhdXV2b3dlbHNpZ250YW1pbBJjYWlpdm93ZWxzaWdudGFtaWwRY2F1dm93ZWxzaWdudGFtaWwSY2F1dXZvd2Vsc2lnbnRhbWlsEmphaWl2b3dlbHNpZ250YW1pbBNueWFpaXZvd2Vsc2lnbnRhbWlsEm55YXV2b3dlbHNpZ250YW1pbBNueWF1dXZvd2Vsc2lnbnRhbWlsEnR0YWl2b3dlbHNpZ250YW1pbBN0dGFpaXZvd2Vsc2lnbnRhbWlsEnR0YXV2b3dlbHNpZ250YW1pbBN0dGF1dXZvd2Vsc2lnbnRhbWlsE25uYWlpdm93ZWxzaWdudGFtaWwSbm5hdXZvd2Vsc2lnbnRhbWlsE25uYXV1dm93ZWxzaWdudGFtaWwUbm5uYXV1dm93ZWxzaWdudGFtaWwScGFpaXZvd2Vsc2lnbnRhbWlsEXBhdXZvd2Vsc2lnbnRhbWlsEnBhdXV2b3dlbHNpZ250YW1pbBJtYWlpdm93ZWxzaWdudGFtaWwRbWF1dm93ZWxzaWdudGFtaWwSbWF1dXZvd2Vsc2lnbnRhbWlsEnlhaWl2b3dlbHNpZ250YW1pbBF5YXV2b3dlbHNpZ250YW1pbBJ5YXV1dm93ZWxzaWdudGFtaWwScmFpaXZvd2Vsc2lnbnRhbWlsEXJhdXZvd2Vsc2lnbnRhbWlsEnJhdXV2b3dlbHNpZ250YW1pbBNycmFpaXZvd2Vsc2lnbnRhbWlsEnJyYXV2b3dlbHNpZ250YW1pbBNycmF1dXZvd2Vsc2lnbnRhbWlsEWxhaXZvd2Vsc2lnbnRhbWlsEmxhaWl2b3dlbHNpZ250YW1pbBFsYXV2b3dlbHNpZ250YW1pbBJsYXV1dm93ZWxzaWdudGFtaWwSbGxhaWl2b3dlbHNpZ250YW1pbBJsbGF1dm93ZWxzaWdudGFtaWwTbGxhdXV2b3dlbHNpZ250YW1pbBRsbGxhaWl2b3dlbHNpZ250YW1pbBNsbGxhdXZvd2Vsc2lnbnRhbWlsFGxsbGF1dXZvd2Vsc2lnbnRhbWlsEnZhaWl2b3dlbHNpZ250YW1pbBF2YXV2b3dlbHNpZ250YW1pbBJ2YXV1dm93ZWxzaWdudGFtaWwTc3NhaWl2b3dlbHNpZ250YW1pbBFzYWl2b3dlbHNpZ250YW1pbBJzYWlpdm93ZWxzaWdudGFtaWwSaGFpaXZvd2Vsc2lnbnRhbWlsFHRjaGFpaXZvd2Vsc2lnbnRhbWlsCXNocml0YW1pbBBpdm93ZWxzaWduNHRhbWlsEGl2b3dlbHNpZ24zdGFtaWwQaXZvd2Vsc2lnbjJ0YW1pbBBpdm93ZWxzaWduMXRhbWlsEnV2b3dlbHNpZ25hbHR0YW1pbBN1dXZvd2Vsc2lnbmFsdHRhbWlsDGV4Y2xhbS50YW1pbA5xdW90ZWRibC50YW1pbBBudW1iZXJzaWduLnRhbWlsDXBlcmNlbnQudGFtaWwRcXVvdGVzaW5nbGUudGFtaWwPcGFyZW5sZWZ0LnRhbWlsEHBhcmVucmlnaHQudGFtaWwOYXN0ZXJpc2sudGFtaWwKcGx1cy50YW1pbAtjb21tYS50YW1pbAxoeXBoZW4udGFtaWwMcGVyaW9kLnRhbWlsC3NsYXNoLnRhbWlsCnplcm8udGFtaWwJb25lLnRhbWlsCXR3by50YW1pbAt0aHJlZS50YW1pbApmb3VyLnRhbWlsCmZpdmUudGFtaWwJc2l4LnRhbWlsC3NldmVuLnRhbWlsC2VpZ2h0LnRhbWlsCm5pbmUudGFtaWwLY29sb24udGFtaWwPc2VtaWNvbG9uLnRhbWlsCmxlc3MudGFtaWwLZXF1YWwudGFtaWwNZ3JlYXRlci50YW1pbA5xdWVzdGlvbi50YW1pbBFicmFja2V0bGVmdC50YW1pbA9iYWNrc2xhc2gudGFtaWwSYnJhY2tldHJpZ2h0LnRhbWlsEWFzY2lpY2lyY3VtLnRhbWlsEHVuZGVyc2NvcmUudGFtaWwPYnJhY2VsZWZ0LnRhbWlsCWJhci50YW1pbBBicmFjZXJpZ2h0LnRhbWlsEGFzY2lpdGlsZGUudGFtaWwNdW5pMDBBMC50YW1pbA11bmkwMEFELnRhbWlsDGVuZGFzaC50YW1pbAxlbWRhc2gudGFtaWwPcXVvdGVsZWZ0LnRhbWlsEHF1b3RlcmlnaHQudGFtaWwScXVvdGVkYmxsZWZ0LnRhbWlsE3F1b3RlZGJscmlnaHQudGFtaWwOZWxsaXBzaXMudGFtaWwObXVsdGlwbHkudGFtaWwMZGl2aWRlLnRhbWlsC21pbnVzLnRhbWlsDXVuaTIwQjkudGFtaWwHdW5pMDk1MQd1bmkwOTUyDXVuaTA5NjQudGFtaWwNdW5pMDk2NS50YW1pbAd1bmkxQ0RBB3VuaUE4RjMGdTExMzAxFmNhbmRyYWJpbmR1XzA5NTFfdGFtaWwWY2FuZHJhYmluZHVfMUNEQV90YW1pbAZ1MTEzMDMGdTExMzNCBnUxMTMzQwd1bmkwMEIyB3VuaTAwQjMHdW5pMjA3NAd1bmkyMDgyB3VuaTIwODMHdW5pMjA4NAd1bmkyMDBCB3VuaTIwMEMHdW5pMjAwRAd1bmkyMDEwB3VuaTI1Q0MHdW5pMDMwOAlncmF2ZWNvbWIJYWN1dGVjb21iB3VuaTAzMEIHdW5pMDMwNAZBYnJldmUHQW1hY3JvbgdBb2dvbmVrCkNkb3RhY2NlbnQGRGNhcm9uBkRjcm9hdAZFY2Fyb24KRWRvdGFjY2VudAdFbWFjcm9uB0VvZ29uZWsHdW5pMDEyMgpHZG90YWNjZW50BEhiYXICSUoHSW1hY3JvbgdJb2dvbmVrB3VuaTAxMzYGTGFjdXRlBkxjYXJvbgd1bmkwMTNCBk5hY3V0ZQZOY2Fyb24HdW5pMDE0NQNFbmcNT2h1bmdhcnVtbGF1dAdPbWFjcm9uBlJhY3V0ZQZSY2Fyb24HdW5pMDE1NgZTYWN1dGUHdW5pMDIxOAd1bmkxRTlFBlRjYXJvbgd1bmkwMjFBBlVicmV2ZQ1VaHVuZ2FydW1sYXV0B1VtYWNyb24HVW9nb25lawVVcmluZwZXYWN1dGULV2NpcmN1bWZsZXgJV2RpZXJlc2lzBldncmF2ZQtZY2lyY3VtZmxleAZZZ3JhdmUGWmFjdXRlClpkb3RhY2NlbnQGYWJyZXZlB2FtYWNyb24HYW9nb25lawpjZG90YWNjZW50BmRjYXJvbgZlY2Fyb24KZWRvdGFjY2VudAdlbWFjcm9uB2VvZ29uZWsHdW5pMDEyMwpnZG90YWNjZW50BGhiYXICaWoHaW1hY3Jvbgdpb2dvbmVrB3VuaTAyMzcHdW5pMDEzNwZsYWN1dGUGbGNhcm9uB3VuaTAxM0MGbmFjdXRlBm5jYXJvbgd1bmkwMTQ2A2VuZw1vaHVuZ2FydW1sYXV0B29tYWNyb24GcmFjdXRlBnJjYXJvbgd1bmkwMTU3BnNhY3V0ZQd1bmkwMjE5BnRjYXJvbgd1bmkwMjFCBnVicmV2ZQ11aHVuZ2FydW1sYXV0B3VtYWNyb24HdW9nb25lawV1cmluZwZ3YWN1dGULd2NpcmN1bWZsZXgJd2RpZXJlc2lzBndncmF2ZQt5Y2lyY3VtZmxleAZ5Z3JhdmUGemFjdXRlCnpkb3RhY2NlbnQERXVybwd1bmkwMzA3B3VuaTAzMDIHdW5pMDMwQwd1bmkwMzA2B3VuaTAzMEEJdGlsZGVjb21iB3VuaTAzMTIHdW5pMDMyNgd1bmkwMzI3B3VuaTAzMjgJb3ZlcnNjb3JlCW1hY3Jvbm1vZBBjYXJvbmNvbW1hYWNjZW50EWNvbW1hYWNjZW50cm90YXRlAAEAAAAKAHgA1gAEREZMVABcbGF0bgA4dGFtbAAsdG1sMgAaAAQAAAAA//8ABAAAAAMABQAGAAQAAAAA//8AAQACABwAAk1PTCAAEFJPTSAAEAAA//8AAwAEAAUABgAA//8AAQAEAAQAAAAA//8ABAAAAAEABQAGAAdhYnZtAFhkaXN0AFJkaXN0AEpkaXN0AEBrZXJuADptYXJrADRta21rACwAAAACAAcACAAAAAEABgAAAAEAAQAAAAMAAgADAAQAAAACAAIAAwAAAAEABAAAAAEAAAAJKF4gehQkEcoQhBB0ARYAzgAUAAYAEAABAAoAAgABAKAAoAABAG4ADAAMAFwAVgBQAEoARAA+ADgAMgAsACYAIAAaAAH//gLKAAH+zALbAAEABAMxAAEAAQLhAAEAAgL+AAEAAgL9AAEAAALhAAEAAQKnAAEANgL+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`;

(pdfMake as any).vfs = {
  'NotoSansTamil-Regular.ttf': notoSansTamilBase64,
};

export function exportToExcel(records: RentalRecord[], filename: string = 'kbs-tractors-records.xlsx') {
  const worksheet = XLSX.utils.json_to_sheet(records.map(record => ({
    'பெயர்': record.name,
    'மா': record.acres,
    'வகை': record.equipment_type,
    'சால்': record.rounds,
    'மொத்த தொகை': record.total_amount,
    'பெறப்பட்ட தொகை': record.received_amount,
    'தேதி': new Date(record.created_at).toLocaleDateString('ta-IN')
  })));

  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, 'Rental Records');
  XLSX.writeFile(workbook, filename);
}

export function exportToPDF(records: RentalRecord[], filename: string = 'kbs-tractors-records.pdf') {
  try {
    const headers = [
      { text: 'பெயர்', style: 'tableHeader' },
      { text: 'மா', style: 'tableHeader' },
      { text: 'வகை', style: 'tableHeader' },
      { text: 'சால்', style: 'tableHeader' },
      { text: 'மொத்தம்', style: 'tableHeader' },
      { text: 'பெறப்பட்டது', style: 'tableHeader' },
      { text: 'நிலுவை', style: 'tableHeader' },
      { text: 'தேதி', style: 'tableHeader' }
    ];
    const body = records.map(record => [
      record.name,
      record.acres.toString(),
      record.equipment_type,
      record.rounds.toString(),
      formatCurrency(record.total_amount),
      formatCurrency(record.received_amount),
      formatCurrency(record.total_amount - record.received_amount),
      new Date(record.created_at).toLocaleDateString('ta-IN')
    ]);
    const docDefinition = {
      content: [
        { text: 'KBS Tractors - Rental Records', fontSize: 20, margin: [0, 0, 0, 10] },
        { text: `Generated on: ${new Date().toLocaleDateString()}`, fontSize: 12, margin: [0, 0, 0, 20] },
        {
          table: {
            headerRows: 1,
            widths: ['*', '*', '*', '*', '*', '*', '*', '*'],
            body: [headers, ...body]
          },
          layout: {
            fillColor: (rowIndex: number) => rowIndex === 0 ? '#3B82F6' : (rowIndex % 2 === 0 ? '#F3F4F6' : null)
          }
        }
      ],
      defaultStyle: {
        font: 'NotoSansTamil',
        fontSize: 10
      },
      styles: {
        tableHeader: {
          bold: true,
          color: 'white',
          font: 'NotoSansTamil',
          fontSize: 10
        }
      },
      fonts: {
        NotoSansTamil: {
          normal: 'NotoSansTamil-Regular.ttf',
          bold: 'NotoSansTamil-Regular.ttf',
          italics: 'NotoSansTamil-Regular.ttf',
          bolditalics: 'NotoSansTamil-Regular.ttf'
        }
      }
    };
    pdfMake.createPdf(docDefinition).download(filename);
  } catch (err) {
    alert('PDF export failed: ' + (err instanceof Error ? err.message : err));
  }
}